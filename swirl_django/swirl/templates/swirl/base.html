{% load static %}
<html>

<head>
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.8.2/css/all.css">
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Gotu&family=Lato:wght@300&display=swap" rel="stylesheet">
    <!-- Bootstrap core CSS -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.5.0/css/bootstrap.min.css" rel="stylesheet">
    <!-- Material Design Bootstrap -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/mdbootstrap/4.19.0/css/mdb.min.css" rel="stylesheet">
    <link rel="stylesheet" href="{% static 'css/swirl.css' %}" />
    <title>Swirl</title>
 
    <script type="text/javascript"> let user = '{{request.user}}'
    function getToken(name) {
        let cookieValue=null;
        if(document.cookie && document.cookie !==''){
            let cookies = document.cookie.split(';');
            for(let i =0;i<cookies.length;i++) {
                let cookie= cookies[i].trim();
                if(cookie.substring(0,name.length+1)===(name+'=')){
                    cookieValue = decodeURIComponent(cookie.substring(name.length +1));
                    break;
                }
            }
        }
        return cookieValue
    }
    let csrftoken = getToken('csrftoken')

    function getCookie(name){
        let cookieArr = document.cookie.split(';');
        for(let i =0; i<cookieArr.length; i++ ) {
            let cookiePair = cookieArr[i].split('=');
            if(name == cookiePair[0].trim()) {
                return decodeURIComponent(cookiePair[1]);
            }
        }
        return null
    }
    let cart = JSON.parse(getCookie('cart'))
    if(cart== undefined) {
        cart = {
            
        }
        console.log('cart was create')
        document.cookie = 'cart=' + JSON.stringify(cart) + ";domain=;path=/"
    }
    </script>
</head>

<body>
    <div class='main-body'> 
        <nav class="navbar navbar-expand-lg navbar-dark ">
            <a class="navbar-brand" href="#">logo</a>
            <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav"
                aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav">
                    <li class="nav-item ">
                        <a class="nav-link" href="/products/">Home <span class="sr-only">(current)</span></a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#">Features</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#">Pricing</a>
                    </li>
                    <li class="nav-item">
                    </li>
                </ul>
                <a href='/cart/'> <img class= 'cart-icon' src='https://tkdesignportfolio.s3-us-west-1.amazonaws.com/swirl/cart.svg'> </a><p>{{cartItems}}</p>
                <body>
                    {% block body %}                
                    <div>
                        <strong>Menu:</strong>
                        <ul>
                            {% if user.is_authenticated %}
                            <li><a href="{% url 'account_email' %}">Change E-mail</a></li>
                            <li><a href="{% url 'account_logout' %}">Sign Out</a></li>
                            {% else %}
                            <li><a href="{% url 'account_login' %}">Sign In</a></li>
                            <li><a href="{% url 'account_signup' %}">Sign Up</a></li>
                            {% endif %}
                        </ul>
                    </div>
                  
                    {% endblock %}
            </div>
        </nav>
        {% block content %} {% endblock %}
        
        <script type="text/javascript" src="{% static 'js/cart.js' %}"> </script>
        <!-- JQuery -->
        <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
        <!-- Bootstrap tooltips -->
        <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.4/umd/popper.min.js"></script>
        <!-- Bootstrap core JavaScript -->
        <script type="text/javascript"
            src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.5.0/js/bootstrap.min.js"></script>
        <!-- MDB core JavaScript -->
        <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mdbootstrap/4.19.0/js/mdb.min.js"></script>
    </div>
</body>
</html>